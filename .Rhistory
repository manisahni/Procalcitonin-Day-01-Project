dim(dim)
dim(data)
data <-createDataPartition(y=spam$type,p = 0.75, list=FALSE)
dim(data)
data <-createDataPartition(y=spam$type,p=0.75, list=FALSE)
dim(data)
library(caret)
library(kernlab)
data(spam)
inTrain <- createDataPartition(y=spam$type,p=0.75, list=FALSE)
training <-spam[inTrain,]
testing <-spam[-inTrain,]
dim(training)
set.seed(32343)
modelFit <- train(type~., data=training,method="glm")
modelFit
modelFit$finalModel
modelFit$finalModel
predictions <- predict(modelFit,newdata=testing)
predictions
confusionMatrix(predictions,testing$type)
args(train.default)
args(traincontrol)
args(trainControl)
insttall.packages(ISLR)
install.packages("ISLR")
data(wage)
library(ISLR)
data(wage)
library(Wage)
data(Wage)
Head(Wage)
head(Wage)
summary(Wage)
inTrain <- createDataPartition(y=Wage$wage, p=0.75,list=FALSE)
training <-Wage[inTrain,]
testing <- Wage[-inTrain]
dim(training)
dim(testing)
testing <- Wage[-inTrain,]
dim(training);dim(testing)
head(Wage)
inTrain <- createDataPartition(y=Wage$wage, p=0.75,list=FALSE)
training <-Wage[inTrain,]
testing <- Wage[-inTrain]
dim(training)
inTrain <- createDataPartition(y=Wage$wage, p=0.7,list=FALSE)
training <-Wage[inTrain,]
testing <- Wage[-inTrain]
dim(training)
inTrain <- createDataPartition(y=Wage$wage, p=0.7,list=FALSE)
training <-Wage[inTrain,]
testing <- Wage[-inTrain]
dim(training)
featurePlot??
?
??featurePlot
featurePlot(x=training[,c("age","education","jobclass")], y=training$Wage, plot="pairs")
setwd("~/Desktop")
setwd("~/Desktop/Procalcitonin Day 01 Priject")
anonMASTER <- read.csv("~/Desktop/Procalcitonin Day 01 Priject/anonMASTER.csv")
View(anonMASTER)
library(ggplot2)
library(caret)
library(dplyr)
data <- anonMASTER
data
data <- anonMASTER
data <- tbl_df(data)
data
qplot(LACTATE.d01,Survival,data)
data
qplot(LACTATE.d01,Survival,data=data)
qplot(LACTATE.d01,Survival,data=data, colour=Survival)
qplot(LACTATE.d01,Survival,data=data, colour=Survival, geom=c("point","smooth"), method=lm)
qplot(LACTATE.d01,Survival,data=data, colour=Transplant.x, geom=c("point","smooth"), method=lm)
qplot(LACTATE.d01,Survival,data=data, colour=Transplant.y, geom=c("point","smooth"), method=lm)
qplot(LACTATE.d01,Survival,data=data, colour=ESLD, geom=c("point","smooth"), method=lm)
qplot(PROCALCITONIN.d01,Survival,data=data, geom=c("point","smooth"), method=lm)
qplot(PROCALCITONIN.d01,Survival,data=data,colour=PROCALCITONIN.d01 geom=c("point","smooth"), method=lm)
qplot(PROCALCITONIN.d01,Survival,data=data,colour=PROCALCITONIN.d01, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=PROCALCITONIN.d01, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=Transplant.y, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=PROCALCITONIN.d01, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=ESLD, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=CHF, geom=c("point","smooth"), method=lm)
qplot(log(LACTATEA.d01),Survival,data=data,colour=CHF, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=CHF, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=ESRD_CKD5, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=ESRD_CKD5, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=DM2, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=DM2, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=gender, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=gender, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=IMMUNE,colour=, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=IMMUNE, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=CHEMORAD, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=CHEMORAD, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=aki, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=CatheterCPT, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=RRTCPT, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=VentCPT, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=VentCPT, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=LACTATE.d01, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=aki, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=aki, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=aki, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=data,colour=aki, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=Transplant.y, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=ESLD, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=data,colour=ESLD, geom=c("point","smooth"), method=lm)
library(ggplot2)
qplot(log(LACTATE.d01),Survival,data=data,colour=ESLD, geom=c("point","smooth"), method=lm)
count(susbet(data,WBC.d01<=2))
table(subset(data,WBC.d01<=2))
length(subset(data,WBC.d01<=2))
length(subset(data,WBC.d01<=3))
length(subset(data,WBC.d01<=4))
length(subset(data,WBC.d01<=5))
length(subset(data,WBC.d01<=6))
length(subset(data,WBC.d01<=7))
length(subset(data,WBC.d01<=8))
m <- (subset(data,WBC.d01<=8))
m
View(m)
m <- (subset(data,WBC.d01<=4))
m
m <- (subset(data,WBC.d01<=3))
m
View(m)
m <- (subset(data,WBC.d01<=4))
m
View(m)
qplot(log(LACTATE.d01),Survival,data=m,colour=PLevel, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=m, geom=c("point","smooth"), method=lm)
View(m)
qplot(log(PROCALCITONIN.d01),Survival,data=m, geom=c("point","smooth"), method=lm)
save.image("~/Desktop/Procalcitonin Day 01 Priject/surival analysis from day01 labs.RData")
library(survival)
libary(caret)
library(caret)
esld <- subset(data, ESLD=ESLD)
esld
View(ESLD)
View(esld)
esld <- subset(data, ESLD=="ESLD")
elsd
esld <- esld
View(esld)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),Survival,data=esld, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"),colour=aki, method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"),colour=DM2, method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"),colour=VENTCPT, method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"),colour=VentCPT, method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"),colour=RRTCPT, method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"),colour=PHtn, method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esld, geom=c("point","smooth"),colour=rrtbin, method=lm)
qplot(log(PROCALCITONIN.d01),rationcr,data=esld, geom=c("point","smooth"),colour=PHtn, method=lm)
qplot(log(PROCALCITONIN.d01),rationcr,data=esld, geom=c("point","smooth"), method=lm)
qplot(log(LACTATE.d01),rationcr,data=esld, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),rationcr,data=esld, geom=c("point","smooth"), method=lm)
glm <- glm(devaki ~ PROCALCITONIN.d01,data=esld)
summary(glm)
glm <- glm(devaki ~ PROCALCITONIN.d01 +CR.d01,data=esld)
summary(glm)
glm <- glm(devaki ~ PROCALCITONIN.d01 +CR.d01,data=data)
summary(glm)
glm <- glm(devaki ~ PROCALCITONIN.d01,data=data)
glm
glm <- glm(devaki ~ PROCALCITONIN.d01 +CR.d01,data=data)
summary(glm)
glm <- glm((d2max_cr/CR.d01) ~ PROCALCITONIN.d01 +CR.d01,data=data, method="poisson")
glm <- glm((d2max_cr/CR.d01) ~ PROCALCITONIN.d01 +CR.d01,data=data)
summary(glm)
nonesrd <- subset(data,ESRD_CKD5 = "non ESRD.CKD5")
glm <- glm((d2max_cr/CR.d01) ~ PROCALCITONIN.d01 +CR.d01,data=nonesrd)
summary(glm)
glm <- glm(ratiocr ~ PROCALCITONIN.d01 +CR.d01,data=nonesrd)
summary(glm)
glm <- glm(fractioncrchange ~ PROCALCITONIN.d01 +CR.d01,data=nonesrd)
summary(glm)
glm <- glm(fractioncrchange ~ PROCALCITONIN.d01 +CR.d01,data=nonesrd)
summary(glm)
survivalglm <- glm(event~ PROCALCITONIN.D01+LACTATE.D01+CR.D01)
survivalglm <- glm(event~ PROCALCITONIN.D01+LACTATE.D01+CR.D01, data=esld, method="binomial")
survivalglm <- glm(event~ PROCALCITONIN.d01+LACTATE.d01+CR.d01, data=esld, method="binomial")
survivalglm <- glm(event ~ PROCALCITONIN.d01+LACTATE.d01+CR.d01, data=esld, method=binomial)
survivalglm <- glm(event ~ PROCALCITONIN.d01+LACTATE.d01+CR.d01, data=esld)
summary(glm)
survivalglm <- glm(event ~ PROCALCITONIN.d01+CR.d01, data=esld)
summaryglm
summary(glm)
summary(survivalglm)
survivalglm <- glm(event ~ PROCALCITONIN.d01+CR.d01+LACTATE.d01, data=esld)
summary(survivalglm)
survivalglm <- glm(event ~ PROCALCITONIN.d01+CR.d01+LACTATE.d01, data=data)
summary(survivalglm)
survivalglm <- glm(aki ~ PROCALCITONIN.d01+CR.d01+LACTATE.d01, data=esld)
View(survivalglm)
summary(survival(glm))
summary(survivalglm)
qplot(PROCALCITONIN.d01,LACTATE.d01,data=data)
qplot(log2(PROCALCITONIN.d01),log2(LACTATE.d01),data=data)
qplot(log2(PROCALCITONIN.d01),log2(LACTATE.d01),data=data,geom=c('smooth'))
qplot(log2(PROCALCITONIN.d01),log2(LACTATE.d01),data=data,geom=c('smooth'),method=lm)
qplot(log2(d2max_cr),log2(PROCALCITONIN.d01),data=data,geom=c('smooth'),method=lm)
qplot(log2(PROCALCITONIN.d01),log2(d2max_cr),data=data,geom=c('smooth'),method=lm)
qplot(log2(LACTATE.d01),log2(d2max_cr),data=data,geom=c('smooth'),method=lm)
qplot(log2(PROCALCITONIN.d01),log2(d2max_cr),data=data,geom=c('smooth'),method=lm)
qplot(log2(PROCALCITONIN.d01),(d2max_cr-CR.d01),data=data,geom=c('smooth'),method=lm)
qplot(log2(PROCALCITONIN.d01),(d2max_cr-CR.d01),data=data)
qplot(log2(PROCALCITONIN.d01),log2(d2max_cr),data=data,geom=c('smooth'),method=lm)
qplot(log2(PROCALCITONIN.d01),log2(CR.d01),data=data,geom=c('smooth'),method=lm)
qplot(log2(PROCALCITONIN.d01),aki,data=data,geom=c('smooth'),method=lm)
qplot(log2(PROCALCITONIN.d01),aki,data=data)
rattle()
g <- glm(d2max_cr~PROCALCITONIN.d01, data=data)
summary(g)
g <- glm(abs(d2max_cr-CR.d01)~PROCALCITONIN.d01, data=data)
summary(g)
g <- glm(abs((d2max_cr-CR.d01)/CR.d01)~PROCALCITONIN.d01, data=data)
summary(glm)
summary(g)
g <- glm(abs(d2max_cr-CR.d01)~PROCALCITONIN.d01, data=data)
summary(g)
g <- glm((d2max_cr/CR.d01)~PROCALCITONIN.d01, data=data)
summary(g)
g <- glm(abs(d2max_cr-CR.d01)~PROCALCITONIN.d01, data=data)
summary(g)
g <- glm(abs(d2max_cr-CR.d01)~PROCALCITONIN.d01, data=data,method=logit)
g <- glm(abs(d2max_cr-CR.d01)~PROCALCITONIN.d01, data=data,method=binomial)
g <- glm(abs(d2max_cr-CR.d01)~PROCALCITONIN.d01, data=data)
summary(g)
g <- glm(abs(d2max_cr-CR.d01)~PROCALCITONIN.d01 + CR.d01, data=data)
summary(g)
g <- glm(rrtbin~PROCALCITONIN.d01 + CR.d01, data=data)
summary(g)
g <- glm(rrtbin~PROCALCITONIN.d01, data=data)
summary(g)
g <- glm(rrtbin~PROCALCITONIN.d01, data=esld)
summary(g)
g <- glm(rrtbin~PROCALCITONIN.d01 + CR.d01, data=esld)
summary(g)
g <- glm(rrtbin~PROCALCITONIN.d01 + CR.d01 + CHF + Transplant.y , data=esld)
summary(g)
g <- glm(rrtbin~PROCALCITONIN.d01 + CR.d01 + CHF , data=esld)
summary(g)
g <- glm(rrtbin~PROCALCITONIN.d01 + CR.d01 , data=esld)
summary(g)
g <- glm(rrtbin~WBC.d01 + CR.d01 , data=esld)
summary(g)
g <- glm(rrtbin~WBC.d01 +PROCALCITONIN.d01 + CR.d01 , data=esld)
summary(g)
esldnonrrt
esldnonesrd <- subset(esld, ESRD_CKD.5="non ESRD.CKD5")
g <- glm(rrtbin~WBC.d01 +PROCALCITONIN.d01 + CR.d01 , data=esldnonesrd)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 , data=esldnonesrd)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 , data=esldnonesrd)
summarY(g)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 +Htn , data=esldnonesrd)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 +Htn + CHF, data=esldnonesrd)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + CHF + min_sodium + min_hb, data=esldnonesrd)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + CHF + min_sodium + min_hb, data=esldnonesrd, family=binomial)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn , data=esldnonesrd, family=binomial)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn , data=esldnonesrd, family=binomial, link=logit)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn , data=esldnonesrd, family=binomial, link="logit")
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn , data=esldnonesrd, family=binomial(link=logit))
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + PLATELETS.d01, data=esldnonesrd, family=binomial(link=logit))
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + PLATELETS.d01 + ALB.d01, data=esldnonesrd, family=binomial(link=logit))
summary(G)
summary(g)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + PLATELETS.d01 + ALB.d01 +gender, data=esldnonesrd, family=binomial(link=logit))
summary(g)
eventesld <- glm(event~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + PLATELETS.d01 + ALB.d01 +gender, data=esldnonesrd, family=binomial(link=logit))
summary(eventesld)
esldlact <- glm(rrtbin~LACTATE.d01 data=esldnonesrd, family=binomial(link=logit))
esldlact <- glm(rrtbin~LACTATE.d01, data=esldnonesrd, family=binomial(link=logit))
summary(esldlact)
esldlact <- glm(rrtbin~PROCALCITONIN.d01, data=esldnonesrd, family=binomial(link=logit))
esldlact <- glm(rrtbin~LACTATE.d01, data=esldnonesrd, family=binomial(link=logit))
esldlact <- glm(rrtbin~LACTATE.d01+PROCALCITONIN.d01, data=esldnonesrd, family=binomial(link=logit))
summary(esldlact)
rrt <- glm(rrtbin~PROCALCITONIN.d01, data=data, family=binomial(link=logit))
summary(rrt)
nonesrd
View(nonesrd)
fix(g)
rrt
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + PLATELETS.d01 + ALB.d01, data=esldnonesrd, family=binomial(link=logit))
eventesld <- glm(event~log(PROCALCITONIN.d01) data=esldnonesrd, family=binomial(link=logit))
eventesld <- glm(event~log(PROCALCITONIN.d01) ,data=esldnonesrd, family=binomial(link=logit))
summary(eventesld)
eventesld <- glm(event~log(LACTATE.d01) ,data=esldnonesrd, family=binomial(link=logit))
summary(eventesld)
eventesld <- glm(event~log(LACTATE.d01) + log(PROCALCITONIN.d01),data=esldnonesrd, family=binomial(link=logit))
summary(eventesld)
install.packages("relimp")
library(relim)
library(relimp)
g
relimp(g)
??relimp
x <- rnorm(100)
z <- rnorm(100)
w <- rnorm(100)
y <- 3+ 2*x + z + w + rnorm(100)
test <- lm(y ~ x +z +w)
summary(test)
print(test)
print(g)
relimp(test,2,3)
print(g)
relimp(g, 1,2)
relimp(g, 2,3)
relimp(g, 3,4)
chf <- subset(data, CHF=="CHF")
View(chf)
chf <- glm(event~log(LACTATE.d01) + log(PROCALCITONIN.d01),data=chf, family=binomial(link=logit))
summary(chf)
chf <- glm(event~log(PROCALCITONIN.d01),data=chf, family=binomial(link=logit))
chf <- glm(event~ log(PROCALCITONIN.d01), data=chf, family=binomial(link=logit))
chf <- glm(event ~ log(PROCALCITONIN.d01), data=chf, family=binomial)
g <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + PLATELETS.d01 + ALB.d01, data=chf family=binomial(link=logit))
glm.chf <- glm(rrtbin~WBC.d01 + log(PROCALCITONIN.d01) + CR.d01 +DM2 + Htn + PLATELETS.d01 + ALB.d01, data=chf ,family=binomial(link=logit))
chf
chf <- subset(data, CHF=="CHF")
glm.chf <- glm(event~log(LACTATE.d01) + log(PROCALCITONIN.d01),data=chf, family=binomial(link=logit))
summary(glm.chf)
glm.chf <- glm(rrtbin~log(LACTATE.d01) + log(PROCALCITONIN.d01),data=chf, family=binomial(link=logit))
summary(glm.chf)
glm.chf <- glm(rrtbin~log(PROCALCITONIN.d01),data=chf, family=binomial(link=logit))
View(glm.chf)
summary(glm.chf)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01),data=chf, family=binomial)
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+ WBC.d01,data=chf, family=binomial)
summary(glm.chf.aki)
chfnoesrd<- subset(chf, ESRD_CKD5="non ESRD.CKD5" )
chfnoesrd
chfnoesrd<- subset(chf, ESRD_CKD5=="non ESRD.CKD5" )
chfnoesrd
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+ WBC.d01,data=chfnoesrd, family=binomial)
summary(glm.chf.aki)
glm.chf.aki <- glm(event~log(PROCALCITONIN.d01)+ WBC.d01,data=chfnoesrd, family=binomial)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+ WBC.d01,data=chfnoesrd, family=binomial)
glm.chf.rrt <- glm(rrt~log(PROCALCITONIN.d01)+ WBC.d01,data=chfnoesrd, family=binomial)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01,data=chfnoesrd, family=binomial)
summary(glm.chf.rrt)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 + PHtn,data=chfnoesrd, family=binomial)
summary(glm.chf.rrt)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 + PHtn,data=chfnoesrd + ALB.d01, family=binomial)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 + PHtn + ALB,data=chfnoesrd, family=binomial)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 + PHtn + ALB.d01,data=chfnoesrd, family=binomial)
summary(glm.chf.rrt)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 + PHtn + ALB.d01+DM2,data=chfnoesrd, family=binomial)
summary(glm.chf.rrt)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 +CR.d01 + PHtn + ALB.d01+DM2,data=chfnoesrd, family=binomial)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 +CR.d01 + PHtn + ALB.d01+DM2,data=chfnoesrd, family=binomial)
summary(glm.chf.rrt)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 +CR.d01 + PHtn + ALB.d01+DM2 +min_sodium,data=chfnoesrd, family=binomial)
summary(glm.chf.rrt)
glm.chf.rrt <- glm(rrtbin~log(PROCALCITONIN.d01)+ WBC.d01 +CR.d01 + PHtn + ALB.d01+DM2 +min_sodium + min_hb,data=chfnoesrd, family=binomial)
summary(glm.chf.rrt)
glm.chf.aki <- glm(aki~log(PROCALCITONIN.d01)+ WBC.d01 +CR.d01 + PHtn + ALB.d01+DM2 +min_sodium + min_hb,data=chfnoesrd, family=binomial)
summary(glm.chf.aki)
qplot(CR.d01-d2max_cr, log(PROCALCITONIN.d01),data=chfnoesrd)
qplot(CR.d01-d2max_cr, log(PROCALCITONIN.d01),data=chfnoesrd, xlim=-2.5)
qplot(CR.d01-d2max_cr, log(PROCALCITONIN.d01),data=chfnoesrd, xlim>-2.5)
qplot(CR.d01-d2max_cr, log(PROCALCITONIN.d01),data=chfnoesrd)
abline(y=0)
??abline
qplot(CR.d01-d2max_cr, log(PROCALCITONIN.d01),data=chfnoesrd)
qplot( log(PROCALCITONIN.d01),CR.d01-d2max_cr,data=chfnoesrd)
qplot( log(PROCALCITONIN.d01),CR.d01-d2max_cr,data=chfnoesrd, colour=rrtbin)
glm.chf.aki <- glm(aki~log(PROCALCITONIN.d01)+ WBC.d01 + PHtn + ALB.d01+DM2 +min_sodium + min_hb,data=chfnoesrd, family=binomial)
summary(glm.chf.aki)
qplot( log(PROCALCITONIN.d01),CR.d01-d2max_cr,data=chfnoesrd, colour=aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+ WBC.d01 + PHtn + ALB.d01+DM2 +min_sodium + min_hb,data=chfnoesrd, family=binomial)
summary(glm.chf.aki)
qplot( log(PROCALCITONIN.d01),CR.d01-d2max_cr,data=chfnoesrd, colour=devaki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+ WBC.d01 + PHtn + ALB.d01+DM2 +min_sodium + min_hb,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
step.glm <- stepAIC(glm.chf.aki, trace=FALSE)
library(MASS)
step.glm <- stepAIC(glm.chf.aki, trace=FALSE)
step.glm <- stepAIC(glm.chf.aki, trace=true)
step.glm <- stepAIC(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01),data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM@,data=chfnoesrd, family=binomial(link=logit))
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+Htn+PHtn,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn+data=chfnoesrd, family=binomial(link=logit))
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.vent <- glm(VentCPT~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.Vent)
summary(glm.chf.vent)
glm.chf.event <- glm(event~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.event)
glm.chf.vent <- glm(VentCPT~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.event)
summary(glm.chf.vent)
glm.chf.vent <- glm(VentCPT~log(PROCALCITONIN.d01)+LACTATE.d01+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.vent)
glm.chf.vent <- glm(VentCPT~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.vent)
glm.chf.vent <- glm(VentCPT~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn+ESLD+Transplant.y,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.vent)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+LACTATE.d01,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
glm.chf.aki <- glm(devaki~log(PROCALCITONIN.d01)+LACTATE.d01+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn,data=chfnoesrd, family=binomial(link=logit))
summary(glm.chf.aki)
qplot(log(PROCALCITONIN.d01),Survival,data=esldnoesrd,colour=aki, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=esldnonesrd,colour=aki, geom=c("point","smooth"), method=lm)
qplot(log(PROCALCITONIN.d01),Survival,data=chfnoesrd,colour=aki, geom=c("point","smooth"), method=lm)
```
```{r, cache=TRUE}
qplot(log(LACTATE.d01),Survival,data=data,colour=ESLD, geom=c("point","smooth"), method=lm)
install.packages("crs")
library(crs)
vignette("crs",package="crs")
vignette("crs",package="crs")
library(MASS)
library(leaps)
attach(chfnoserd)
attach(chfnosedrd)
attach(chfnonsesrd)
attach(chfnoesrd)
leaps <- regsubsets(glm.chf.acki.lact, data=chfnoesrd, nbest=10)
leaps <- regsubsets(glm.chf.aki.lact, data=chfnoesrd, nbest=10)
leaps <- regsubsets(glm.chf.aki, data=chfnoesrd, nbest=10)
fix(glm.chf.aki)
leaps <- regsubsets(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn+Htn,data=chfnoesrd, family=binomial(link=logit), nbest=10)
leaps <- regsubsets(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn+Htn,data=chfnoesrd, nbest=10)
leaps
summary(leaps)
plot(leaps)
leaps <- regsubsets(devaki~log(PROCALCITONIN.d01)+LACTATE.d01+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn+Htn,data=chfnoesrd, nbest=10)
plot(leaps)
save.image("~/Desktop/Procalcitonin Day 01 Priject/surival analysis from day01 labs.RData")
leaps <- regsubsets(devaki~log(PROCALCITONIN.d01)+WBC.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn+Htn,data=chfnoesrd, nbest=10)
leaps <- regsubsets(devaki~log(PROCALCITONIN.d01)+WBC.d01++LACTATE.d01+DM2+CR.d01+gender+ALB.d01+ESLD+PHtn+Htn,data=chfnoesrd, nbest=10)
plot(leaps)
exp(.69)
10^0.69
install.packages("relimpo")
plot(leaps,scale="r2")
library(relaimpo)
calc.relimp(fit,type=c("lmg","last","first","pratt"),
rela=TRUE)
install.packages("relaimpo")
library(relaimpo)
calc.relimp(fit,type=c("lmg","last","first","pratt"),
rela=TRUE)
??relaimpo
library(relaimpo)
data(swiss)
# Calculate Relative Importance for Each Predictor
library(relaimpo)
calc.relimp(fit,type=c("lmg","last","first","pratt"),
rela=TRUE)
# Bootstrap Measures of Relative Importance (1000 samples)
boot <- boot.relimp(fit, b = 1000, type = c("lmg",
"last", "first", "pratt"), rank = TRUE,
diff = TRUE, rela = TRUE)
booteval.relimp(boot) # print result
plot(booteval.relimp(boot,sort=TRUE)) # plot result
boot <- boot.relimp(fit, b=1000, type= c("lmg","last","first","pratt"), rank=TRUE, diff=TRUE, rela=TRUE)
calc.relimp (glm.chf.aki, b=1000, type= c("lmg","last","first","pratt"), rank=TRUE, diff=TRUE, rela=TRUE)
calc.relimp (glm.chf.aki, b=1000, type= c("lmg","last","first","pratt"), rank=TRUE, diff=TRUE, rela=TRUE)
install.packages("ROCR")
library(ROCR)
help(ROCR)
??ROCR
library(ROCR)
demo(ROCR)
demo(ROCR)
calc.relimp (glm.chf.aki, b=10, type= c("lmg"))
predict(glm.chf.aki)
predict <- predict(glm.chf.aki)
data(ROCR.simple)
View(ROCR.simple)
red <- prediction( ROCR.simple$predictions, ROCR.simple$labels)
pred <- prediction( ROCR.simple$predictions, ROCR.simple$labels)
perf <- performance(pred,"tpr","fpr")
plot(perf)
save.image("~/Desktop/Procalcitonin Day 01 Priject/surival analysis from day01 labs.RData")
